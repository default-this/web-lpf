<lib-cs-binding-edit-sections-container *ngIf="form">
    <lib-cs-binding-edit-section [largeScreenWidthPercentage]="33"
                                 [caption]="'controlScheme.bindingSectionOutputTitle' | transloco"
    >
        <lib-cs-binding-control-select-hub [control]="form.controls.hubId"
                                           [bindingType]="bindingType"
        ></lib-cs-binding-control-select-hub>

        <lib-cs-binding-control-select-io [portIdControl]="form.controls.portId"
                                          [hubIdControl]="form.controls.hubId"
                                          [bindingType]="bindingType"
        ></lib-cs-binding-control-select-io>
    </lib-cs-binding-edit-section>

    <mat-divider [vertical]="true" *libHideOnSmallScreen></mat-divider>

    <lib-cs-binding-edit-section [largeScreenWidthPercentage]="33"
                                 [caption]="'controlScheme.bindingSectionInputTitle' | transloco"
    >
        <lib-cs-binding-control-select-controller [data]="servoControlBindingComponentData"></lib-cs-binding-control-select-controller>
        <lib-cs-binding-control-select-input-gain *ngIf="isInputGainConfigurable"
                                                  [control]="form.controls.inputs.controls[controlSchemeInputActions.Servo].controls.gain"
        ></lib-cs-binding-control-select-input-gain>
    </lib-cs-binding-edit-section>

    <mat-divider [vertical]="true" *libHideOnSmallScreen></mat-divider>

    <lib-cs-binding-edit-section [largeScreenWidthPercentage]="33"
                                 [caption]="'controlScheme.bindingSectionConfigTitle' | transloco"

    >
        <lib-cs-binding-control-speed-input [control]="form.controls.speed"></lib-cs-binding-control-speed-input>
        <lib-cs-binding-control-power-input [control]="form.controls.power"></lib-cs-binding-control-power-input>

        <lib-toggle-control [translocoTitle]="'controlScheme.servoBinding.calibrateOnStart'"
                            [control]="form.controls.calibrateOnStart"
        ></lib-toggle-control>

        <ng-container *ngIf="!form.controls.calibrateOnStart.value">
            <div>
                <button mat-raised-button
                        type="button"
                        color="primary"
                        class="calibrate-button"
                        [disabled]="!(canCalibrate$ | ngrxPush)"
                        (click)="calibrate()"
                >
                    {{ 'controlScheme.servoBinding.calibrate' | transloco }}
                </button>
            </div>

            <mat-form-field>
                <mat-label>{{ 'controlScheme.servoBinding.outputCenterOffset' | transloco }}</mat-label>
                <input type="number"
                       matInput
                       [formControl]="form.controls.aposCenter"
                       [min]="-motorLimits.maxServoDegreesRange / 2"
                       [max]="motorLimits.maxServoDegreesRange / 2"
                />
                <button mat-icon-button
                        matSuffix
                        [disabled]="!(canRequestPortValue$ | ngrxPush)"
                        [title]="'controlScheme.servoBinding.readServoCenterFromPort' | transloco"
                        (click)="onServoCenterReadRequest()"
                >
                    <mat-icon [fontIcon]="'gps_fixed'"></mat-icon>
                </button>
                <mat-error [libValidationMessages]="form.controls.aposCenter"></mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>{{ 'controlScheme.servoBinding.outputAngleRange' | transloco }}</mat-label>
                <input type="number"
                       matInput
                       [formControl]="form.controls.range"
                       [min]="motorLimits.minServoDegreesRange"
                       [max]="motorLimits.maxServoDegreesRange"
                />
                <button mat-icon-button
                        matSuffix
                        [disabled]="!(canRequestPortValue$ | ngrxPush)"
                        [title]="'controlScheme.servoBinding.readServoRangeFromPort' | transloco"
                        (click)="onServoRangeReadRequest()"
                >
                    <mat-icon [fontIcon]="'gps_fixed'"></mat-icon>
                </button>
                <mat-error [libValidationMessages]="form.controls.range"></mat-error>
            </mat-form-field>
        </ng-container>

        <lib-toggle-control [translocoTitle]="'controlScheme.outputInvertControlTitle'"
                            [control]="form.controls.invert"
        ></lib-toggle-control>

        <lib-toggle-control [translocoTitle]="'controlScheme.useAccelerationProfile'"
                            [control]="form.controls.useAccelerationProfile"
        ></lib-toggle-control>

        <lib-toggle-control [translocoTitle]="'controlScheme.useDecelerationProfile'"
                            [control]="form.controls.useDecelerationProfile"
        ></lib-toggle-control>
    </lib-cs-binding-edit-section>
</lib-cs-binding-edit-sections-container>
