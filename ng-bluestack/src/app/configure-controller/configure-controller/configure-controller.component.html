<ng-container [ngSwitch]="controllerConnectionState$ | async">
    <ng-container *ngSwitchCase="controllerConnectionStates.NotConnected">
        <app-controller-type-select #selectedControllerType
                                    [ngModel]="connectedControllerType$ | ngrxPush"
        ></app-controller-type-select>
        <button (click)="onControllerListeningStart(selectedControllerType.value)"
                *ngIf="isControllerTypeSelected(selectedControllerType.value)"
                mat-button>
            {{ 'connectToController$' | l10n }}
        </button>
    </ng-container>

    <ng-container *ngSwitchCase="controllerConnectionStates.Listening">
        <button (click)="cancelListening()" mat-button>
            {{ 'cancelListeningForController$' | l10n }}
        </button>
    </ng-container>

    <ng-container *ngIf="controllerConnectionStates.Connected">
        <ng-container [ngSwitch]="connectedControllerType$ | async">
            <ng-container *ngSwitchCase="controllerTypes.GamePad">
                <ng-container *ngrxLet="controllerConfig$ | async as controllerConfig">
                    <ng-container *ngIf="controllerConfig">
                        <div *ngIf="controllerConfig.nameL10nKey">
                            {{ controllerConfig.nameL10nKey | l10n }}
                        </div>
                        <div>
                            <button (click)="disconnectGamepad(controllerConfig.index)" [color]="'warn'"
                                    mat-button>{{ 'controllerDisconnect$' | l10n }}</button>
                        </div>
                        <div [ngSwitch]="connectedControllerType$ | async">
                            <app-controller-gamepad-view *ngSwitchCase="controllerTypes.GamePad"
                                                         [controllerConfig]="controllerConfig"
                                                         [controllerState]="controllerState$ | async"
                            ></app-controller-gamepad-view>
                        </div>
                    </ng-container>
                </ng-container>
            </ng-container>
            <ng-container *ngSwitchCase="controllerTypes.Keyboard">
                <div>
                    {{ 'controllerTypeKeyboard$' | l10n }}
                </div>
                <div>
                    <button (click)="disconnectKeyboard()" [color]="'warn'"
                            mat-button>{{ 'controllerDisconnect$' | l10n }}</button>
                </div>
                <app-controller-keyboard-view *ngSwitchCase="controllerTypes.Keyboard"
                                              [controllerState]="controllerState$ | async"></app-controller-keyboard-view>
            </ng-container>
        </ng-container>
    </ng-container>
</ng-container>
